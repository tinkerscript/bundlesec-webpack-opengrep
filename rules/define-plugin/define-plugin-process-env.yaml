rules:
  - id: define-plugin-process-env
    message: >
      Passing the entire process.env to DefinePlugin exposes all environment
      variables in the client bundle â€” including secrets, tokens, and internal
      configuration. Pass only the specific variables your application needs.
    severity: ERROR
    languages: [javascript, typescript]
    metadata:
      category: security
      technology:
        - webpack
      cwe:
        - "CWE-526: Cleartext Storage of Sensitive Information in an Environment Variable"
      owasp:
        - "A04:2025 - Cryptographic Failures"
      confidence: HIGH
      likelihood: HIGH
      impact: HIGH
    pattern-either:
      - pattern: |
          new webpack.DefinePlugin({$KEY: process.env, ...})
      - pattern: |
          new webpack.DefinePlugin(process.env)
